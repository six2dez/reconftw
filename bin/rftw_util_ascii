#!/bin/bash

# Load environment variables from reconftw.cfg
# Load environment variables
if [ -f "reconftw.cfg" ]; then
    source reconftw.cfg
else
    echo "Error: reconftw.cfg not found!"
    exit 1
fi

# Colors for console output
green="\033[1;32m"
red="\033[1;31m"
reset="\033[0m"

# Help menu function
function display_help() {
    echo "Usage: $0 [FILE]"
    echo
    echo "Checks if the provided file contains ASCII text."
    echo "Options:"
    echo "  -h, --help    Display this help and exit"
    echo
}

# Validate arguments function
function validate_args() {
    if [[ -z "$1" ]]; then
        echo -e "${red}Error: FILE is required.${reset}"
        display_help
        exit 1
    fi
    if [[ ! -f "$1" ]]; then
        echo -e "${red}Error: $1 is not a file.${reset}"
        exit 2
    fi
}

# Check ASCII text function
function is_ascii_text() {
    local filepath="$1"
    if [[ $(file "$filepath" | grep -o 'ASCII text$') == "ASCII text" ]]; then
        echo -e "${green}$filepath contains ASCII text.${reset}"
    else
        echo -e "${red}$filepath does not contain ASCII text.${reset}"
    fi
}

# Main script execution
if [[ "$1" == "-h" || "$1" == "--help" ]]; then
    display_help
    exit 0
fi

validate_args "$1"
is_ascii_text "$1"
