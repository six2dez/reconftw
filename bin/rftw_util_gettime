#!/bin/bash

# Load environment variables from reconftw.cfg
# Load environment variables
if [ -f "reconftw.cfg" ]; then
    source reconftw.cfg
else
    echo "Error: reconftw.cfg not found!"
    exit 1
fi

# Colors
yellow="\033[1;33m"
red="\033[1;31m"
reset="\033[0m"

# Help menu function
function display_help() {
    echo "Usage: $0 [START_TIME] [END_TIME]"
    echo
    echo "Calculate the elapsed time between two time values in seconds."
    echo "Options:"
    echo "  -h, --help    Display this help and exit"
    echo
}

# Validate arguments function
function validate_args() {
    if [[ -z "$1" || -z "$2" ]]; then
        echo -e "${red}Error: Both START_TIME and END_TIME are required.${reset}"
        display_help
        exit 1
    fi

    if ! [[ "$1" =~ ^[0-9]+$ && "$2" =~ ^[0-9]+$ ]]; then
        echo -e "${red}Error: Both START_TIME and END_TIME should be numeric.${reset}"
        exit 1
    fi
}

# Get elapsed time function
function get_elapsed_time() {
    local start_time="$1"
    local end_time="$2"
    runtime=""
    local T=$((end_time - start_time))
    local D=$((T/60/60/24))
    local H=$((T/60/60%24))
    local M=$((T/60%60))
    local S=$((T%60))
    (( D > 0 )) && runtime="$runtime$D days, "
    (( H > 0 )) && runtime="$runtime$H hours, "
    (( M > 0 )) && runtime="$runtime$M minutes, "
    runtime="$runtime$S seconds."
    echo -e "${yellow}$runtime${reset}"
}

# Main script execution
if [[ "$1" == "-h" || "$1" == "--help" ]]; then
    display_help
    exit 0
fi

validate_args "$1" "$2"
get_elapsed_time "$1" "$2"
